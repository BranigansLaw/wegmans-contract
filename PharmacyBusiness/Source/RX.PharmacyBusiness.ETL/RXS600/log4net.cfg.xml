<log4net>
    <appender name="console" type="log4net.Appender.ColoredConsoleAppender">
        <mapping>
            <level value="FATAL" />
            <foreColor value="Red" />
            <backColor value="White" />
        </mapping>
        <mapping>
            <level value="ERROR" />
            <foreColor value="Red, HighIntensity" />
        </mapping>
        <mapping>
            <level value="WARN" />
            <foreColor value="Yellow" />
        </mapping>
        <mapping>
            <level value="INFO" />
            <foreColor value="Cyan" />
        </mapping>
        <mapping>
            <level value="DEBUG" />
            <foreColor value="Green" />
        </mapping>
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date{HH:mm:ss} [%-5level] %logger: %message%newline" />
        </layout>
    </appender>

    <appender name="eventlog" type="log4net.Appender.EventLogAppender" >
        <logName  value="Application" />
        <applicationName  value="RXS600.ps1" />
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%d{ABSOLUTE} [%thread] %-5p %logger{2}: %message%n" />
        </layout>
        <threshold value="INFO"/>
    </appender>

    <appender name="metabase" type="log4net.Appender.AdoNetAppender">
        <connectionType value="Oracle.DataAccess.Client.OracleConnection, Oracle.DataAccess, Version=2.112.3.0, Culture=neutral, PublicKeyToken=89b483f429c47342" />
        <connectionString value="Data Source=SCRIPTS_METABASE;User ID=/;Password=/; Connection Timeout=10; Max Pool size=15; Min Pool Size=5; Incr Pool Size=5; Decr Pool Size=2; Self Tuning=false" />
        <commandText value="BEGIN TRACE_PKG.INSERT_TRACE(:log_date, 'Batch Job', '', :trace_level, :logger, :message, :exception, :host); END;" />
        <parameter>
            <parameterName value=":log_date" />
            <dbType value="DateTime" />
            <layout type="log4net.Layout.RawTimeStampLayout" />
        </parameter>
        <parameter>
            <parameterName value=":trace_level" />
            <dbType value="String" />
            <size value="10" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%level" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value=":logger" />
            <dbType value="String" />
            <size value="255" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%logger" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value=":message" />
            <dbType value="String" />
            <size value="4000" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%m" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value=":exception" />
            <dbType value="String" />
            <size value="4000" />
            <layout type="log4net.Layout.ExceptionLayout" />
        </parameter>
        <parameter>
            <parameterName value=":host" />
            <dbType value="String" />
            <size value="50" />
            <layout type="log4net.Layout.PatternLayout" value="%property{log4net:HostName}" />
        </parameter>
    </appender>

    <!-- Setup the root category, add the appenders and set the default priority -->
    <root>
        <appender-ref ref="console" />
        <appender-ref ref="eventlog" />
        <appender-ref ref="metabase" />
    </root>
</log4net>